<!DOCTYPE html><html lang=en-GB><head><meta name=viewport content="width=device-width, initial-scale=1"><meta name=keywords content=""><meta name=no-email-collection content="/privacy.txt"><meta name=twitter:card content=summary_large_image><meta property=og:title content="Callable Class Instance • Greg Daynes"><meta property="og:description" name=description content="The website and home of Gregory Daynes. Find links to projects, notebooks, and resume."><meta property="og:image" content="data:;base64,iVBORw0KGgo="><title>Callable Class Instance • Greg Daynes</title><link rel=me href="//mastodon.social/@gregdaynes"><link rel=author href="/humans.txt"><link rel=icon href="data:;base64,iVBORw0KGgo="><link type="application/atom+xml" rel=alternate href="/feed.xml"><link rel=stylesheet href="/assets/css/variables-critical-text-fit-toc-list-88113d.css"><style>code{font-size:.9em}p>code{background:var(--_color-background-code)}div.highlight{overflow:scroll;background:var(--_color-background-code)}pre{margin-block:0;padding:var(--s-1);border-radius:3px;overflow-x:auto}.footnotes p{margin-block-end:0}blockquote{border-inline-start:4px solid;padding-inline-start:1rem;margin-inline:auto;font-weight:bold;font-style:italic}</style></head><body class="page callable-class-instance"><img src="//analytics.app.gregdaynes.com?type=image&page=/note/2024/07/30/callable-class-instance.html" width=0 height=0 /><header><h1 class=text-fit><span><a data-text="Greg Daynes" href="/">Greg Daynes</a></span><span aria-hidden=true style="visibility: hidden">Greg Daynes</span></h1><p class=text-fit><span><span>Full Stack Software Design, Development & Management</span></span><span aria-hidden=true style="visibility: hidden">Full Stack Software Design, Development & Management</span></p><nav><ul><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/resume">Resume</a></li><li><a href="/projects">Projects</a></li><li><a href="/notebook">Notebook</a></li></ul></nav></header><div class=with-sidebar><main><article><h2>Callable Class Instance</h2><p>I encountered a situation in Javascript, where I needed a Class instance that could be called like a function.</p><p>StackOverflow to the rescue<sup id="fnref:1"><a href="#fn:1" class=footnote rel=footnote role=doc-noteref>1</a></sup></p><div class="language-javascript highlighter-rouge"><div class=highlight><pre class=highlight><code><span class="k">import</span> <span class="nx">test</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">node:test</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">assert</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">node:assert/strict</span><span class="dl">'</span>

<span class="nf">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">Callable ClassInstance</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">class</span> <span class="nc">Callable</span> <span class="kd">extends</span> <span class="nc">Function</span> <span class="p">{</span>
    <span class="nf">constructor </span><span class="p">()</span> <span class="p">{</span>
      <span class="k">super</span><span class="p">(</span><span class="dl">'</span><span class="s1">...args</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">return this.fn(...args)</span><span class="dl">'</span><span class="p">)</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">fn </span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">called</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">callableInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Callable</span><span class="p">()</span>
  <span class="nf">callableInstance</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div><p>Another approach, much simpler is to define a function, then attach properties to it.</p><div class="language-javascript highlighter-rouge"><div class=highlight><pre class=highlight><code><span class="nf">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">Callable Object Instance</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nf">Callable</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">const</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">called</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">fn</span><span class="p">.</span><span class="nx">someProperty</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">prop</span><span class="dl">'</span>

    <span class="k">return</span> <span class="nx">fn</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">callableInstance</span> <span class="o">=</span> <span class="nc">Callable</span><span class="p">()</span> 
  <span class="nf">callableInstance</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div><p>This approach breaks sharing Prototype Shapes, so too many of these will be problematic for memory<sup id="fnref:2"><a href="#fn:2" class=footnote rel=footnote role=doc-noteref>2</a></sup><sup id="fnref:3"><a href="#fn:3" class=footnote rel=footnote role=doc-noteref>3</a></sup>.</p><h2 id=references>References</h2><div class=footnotes role=doc-endnotes><ol><li id="fn:1"><p><a href="//stackoverflow.com/questions/49279702/calling-class-instance-as-a-function-in-javascript">Calling class instance as a function in JavaScript</a> <a href="#fnref:1" class=reversefootnote role=doc-backlink>&#8617;</a></p></li><li id="fn:2"><p><a href="//developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">MDN</a> <a href="#fnref:2" class=reversefootnote role=doc-backlink>&#8617;</a></p></li><li id="fn:3"><p><a href="//mathiasbynens.be/notes/shapes-ics#shapes">JavaScript engine fundamentals: Shapes and Inline Caches</a> <a href="#fnref:3" class=reversefootnote role=doc-backlink>&#8617;</a></p></li></ol></div></article></main><aside><h2>Projects</h2><nav><ul><li class=""><a href="/project/2023/12/22/hyde-decap.html"> Hyde Decap</a></li><li class=""><a href="/project/2023/12/28/fellow-stagg-repair.html"> Fellow Stagg Repair</a></li><li class=""><a href="/project/2018/04/07/project-hyde.html"> Project Hyde</a></li><li class=""><a href="/project/2023/11/11/turing-pi.html"> Turing Pi</a></li></ul></nav><a href="/projects">More Projects</a><h2>Notes</h2><nav><ul><li class=""><a href="/note/2024/07/30/callable-class-instance.html"> Callable Class Instance</a></li><li class=""><a href="/note/2024/07/29/web-components.html"> Web Components</a></li><li class=""><a href="/note/2024/02/10/hexdump-shell-command.html"> Hexdump shell command</a></li><li class=""><a href="/note/2023/12/08/fixing-homebrew-permissions.html"> Fixing Homebrew permissions when using ASDF</a></li><li class=""><a href="/note/2021/09/18/node-binary-artifacts.html"> Node CLI / Binary Artifacts</a></li></ul></nav><a href="/notebook">More Notes</a></aside></div><footer><p>©2024 Gregory Daynes</p><nav><ul><li><a href="mailto:email@gregdaynes.com">Contact</a></li><li><a href="/privacy.txt">Privacy</a></li><li><a href="/humans.txt">Humans</a></li><li><a href="/robots.txt">Robots</a></li><li><a href="/sitemap.xml">Site Map</a></li><li><a href="/feed.xml">RSS</a></li><li><a href="/stats">Analytics</a></li></ul></nav><p><small>Content on this site is licensed under Creative Common Attribution-ShareAlike 4.0 International License. All code content is licensed under the MIT license, unless an excerpt from a larger work under another license.</small></p></footer></body></html>