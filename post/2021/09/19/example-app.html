<!DOCTYPE html> <!-- Greg Daynes by Gregory Daynes URL: https://gregdaynes.com --> <html lang="en-GB"> <head> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Example NodeJS Application | Greg Daynes</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Example NodeJS Application" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="An example application in NodeJS" /> <meta property="og:description" content="An example application in NodeJS" /> <link rel="canonical" href="https://gregdaynes.com/post/2021/09/19/example-app.html" /> <meta property="og:url" content="https://gregdaynes.com/post/2021/09/19/example-app.html" /> <meta property="og:site_name" content="Greg Daynes" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-09-19T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Example NodeJS Application" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-19T00:00:00+00:00","datePublished":"2021-09-19T00:00:00+00:00","description":"An example application in NodeJS","headline":"Example NodeJS Application","mainEntityOfPage":{"@type":"WebPage","@id":"https://gregdaynes.com/post/2021/09/19/example-app.html"},"url":"https://gregdaynes.com/post/2021/09/19/example-app.html"}</script> <!-- End Jekyll SEO tag --> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="page-datetime" content=""> <meta name="author" content="/humans.txt"> <meta name="keywords" content=""> <meta name="no-email-collection" content="/privacy.txt"> <meta name="description" content="The website and home of Gregory Daynes. Find links to projects, notebooks, and resume."> <meta name='HandheldFriendly' content='True'> <meta name='MobileOptimized' content='375'> <title>Example NodeJS Application &bull; Greg Daynes</title> <link rel="stylesheet" href="/assets/css/variables-reset-utils-toc-list-7e86fd.css?"> <link rel="stylesheet" href="/assets/css/card-6b3f04.css?"> <link rel="stylesheet" href="/assets/css/post-f62800.css?"> <link rel="author" href="/humans.txt" /> <link rel="me" href="https://mastodon.social/@gregdaynes" /> <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg"> <link rel="icon" type="image/png" href="/assets/images/favicon.png"> <link type="application/atom+xml" rel="alternate" href="https://gregdaynes.com/feed.xml" title="Greg Daynes" /> <link rel="shortcut icon" href="/assets/img/favicon-32x32.png" /> <body class="page example-nodejs-application"> <header> <hgroup> <h1><a href="/">Greg Daynes</a></h1> <h2>Full Stack Software Design, Development & Management</h2> </hgroup> <nav> <a href="/">Home</a> <a href="/about">About</a> <a href="/resume">Resume</a> <a href="/projects">Projects</a> <a href="/notebook">Notebook</a> </nav> </header> <div class="main-wrapper"> <main class="stack"> <article> <h2>Example NodeJS Application <hr></h2> <p><em>Note: While this is outdated, some of the takeaways are still valid. I hope to do a follow up - with the same idea using current proven practices and dependencies.</em></p> <p>A <em>mostly</em> complete example for a monolith, which is also suitable for building “microservices”.</p> <ul> <li>Mocha used as test runner for both the Api and the frontend (frontend excluded from this repository). I would personally choose to use <a href="https://www.npmjs.com/package/tap">tap</a> for the Api, and Jest for the Frontend. I dislike Jest for testing Node because of the changes made to the runtime. There are also issues with slow adoption of newer capabilities (because of the these changes)—eg: ESM</li> <li>Replacing the database with SQLite when testing has been a positive choice for fast development (TDD). Given the choice again I would opt to use an in-memory-tuned instance of the production database for integration testing.</li> <li>No workspaces. I ran into an issue with other developers NPM not working with the <em>then new</em> workspace feature (NPM @ 7). Yarn would have worked for this, as well as PNPM.</li> <li>Hygen for generating code based on <code class="language-plaintext highlighter-rouge">ejs</code> templates - <a href="https://www.npmjs.com/package/copy-template-dir">copy-template-dir</a> or similar.</li> <li>CLI came after most of the application and web interface was complete. Nowadays I would build the CLI in parallel with the application logic. This benefits development by not having to remember REPL commands or building out administration uis.</li> </ul> <p>The repository contains <code class="language-plaintext highlighter-rouge">app-example-requests.paw</code> and <code class="language-plaintext highlighter-rouge">app-example-requests-postman.json</code> for interacting with the api through Paw or Postman.</p> <p>Repo: <a href="https://github.com/gregdaynes/app-example">app-example</a></p> <p>Readme in repository has in-depth documentation on the organization, cli, code generation, testing, database.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install modules for each area of the application</span>
<span class="nv">$ </span>npm run setup

<span class="c"># Add required keyvalues to .env</span>
<span class="c"># starting the application will inform you what required values are missing</span>
<span class="c"># you can use the following</span>
<span class="nv">JWT_SECRET</span><span class="o">=</span>supersecret
<span class="nv">DB_CLIENT</span><span class="o">=</span>mysql
<span class="nv">DB_USER</span><span class="o">=</span>root
<span class="nv">DB_PASSWORD</span><span class="o">=</span>root
<span class="nv">DB_DATABASE</span><span class="o">=</span>app
<span class="nv">DB_HOST</span><span class="o">=</span>127.0.0.1
<span class="nv">DB_PORT</span><span class="o">=</span>3306
<span class="nv">TEST_DB_CLIENT</span><span class="o">=</span>sqlite3
<span class="nv">TEST_DB_FILENAME</span><span class="o">=</span>:memory:
<span class="nv">TEST_DB_POOL_MIN</span><span class="o">=</span>1
<span class="nv">TEST_DB_POOL_MAX</span><span class="o">=</span>1

<span class="c"># Setup Database</span>
<span class="c"># if you don't have a local MySQL install, you can use the docker compose file included in this project to set up quickly.</span>
<span class="c"># Note that the envars for MYSQL_ROOT_PASSWORD and MYSQL_DATABASE need to be defined in .env before running the following command.</span>
<span class="nv">$ </span>docker compose up <span class="nt">-d</span>

<span class="c"># Migrate + Seed database</span>
<span class="c"># you can use the script `db` to perform operations with KnexJS or use the CLI</span>
<span class="nv">$ </span>npm run cli

<span class="nv">$ </span>npm run db <span class="nt">--</span> migrate:latest
<span class="nv">$ </span>npm run db <span class="nt">--</span> seed:run

<span class="c"># Running API Server</span>
<span class="nv">$ </span>npm run start:api
<span class="c"># pino-pretty can provide cleaner stdout logs for dev</span>
<span class="nv">$ </span>npm run start:api | npx pino-pretty

<span class="c"># Running Tests</span>
<span class="c"># app tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>:app
<span class="c"># api tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>:api
<span class="c"># api &amp; app tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>
</code></pre></div></div> </article> </main> <aside class="stack"> <section class="stack"> <h2 class="banner">Projects <hr></h2> <div class="stack"> <a class="card" href="/project/2023/12/28/fellow-stagg-repair.html">Fellow Stagg Repair</a> <a class="card" href="/project/2023/12/04/hyde-page-css-js.html">Hyde Page CSS & JS</a> <a class="card" href="/project/2023/12/22/hyde-decap.html">Hyde Decap</a> <a class="card" href="/project/2023/12/03/hyde-fonts.html">Hyde Fonts</a> </div> <span><a class="more" href="/projects">More Projects</a></span> </section> <section class="stack"> <h2 class="banner">Notes <hr></h2> <ol class="toc-list"> <li> <span class="row"> <span class="title"> <a href="/note/2023/12/08/fixing-homebrew-permissions.html">Fixing Hombrew permissions when using ASDF</a> </span> </span> </li> <li> <span class="row"> <span class="title"> <a href="/note/2021/09/18/node-binary-artifacts.html">Node CLI / Binary Artifacts</a> </span> </span> </li> </ol> <span><a class="more" href="/notebook">More Notes</a></span> </section> </aside> </div> <footer> <div>©2024 Gregory Daynes</div> <nav> <a href="mailto:email@gregdaynes.com">Contact</a> <a href="/privacy.txt">Privacy</a> <a href="/humans.txt">Humans</a> <a href="/robots.txt">Robots</a> <a href="/sitemap.xml">Site Map</a> <a href="/feed.xml">RSS</a> </nav> <p><small>Content on this site is licensed under Creative Common Attribution-ShareAlike 4.0 International License. All code content is licensed under the MIT license, unless an excerpt from a larger work under another license.</small></p> </footer> <script src="/assets/js/fitty-header-87b06a.js"></script> </body> </html>
