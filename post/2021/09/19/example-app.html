<!DOCTYPE html><html lang=en-GB><head><meta name=viewport content="width=device-width, initial-scale=1"><meta name=keywords content=""><meta name=no-email-collection content="/privacy.txt"><meta name=twitter:card content=summary_large_image><meta property=og:title content="Example NodeJS Application • Greg Daynes"><meta property="og:description" name=description content="The website and home of Gregory Daynes. Find links to projects, notebooks, and resume."><meta property="og:image" content="data:;base64,iVBORw0KGgo="><title>Example NodeJS Application • Greg Daynes</title><link rel=me href="//mastodon.social/@gregdaynes"><link rel=author href="/humans.txt"><link rel=icon href="data:;base64,iVBORw0KGgo="><link type="application/atom+xml" rel=alternate href="/feed.xml"><link rel=stylesheet href="/assets/css/variables-critical-text-fit-toc-list-88113d.css"><style>code{font-size:.9em}p>code{background:var(--_color-background-code)}div.highlight{overflow:scroll;background:var(--_color-background-code)}pre{margin-block:0;padding:var(--s-1);border-radius:3px;overflow-x:auto}.footnotes p{margin-block-end:0}blockquote{border-inline-start:4px solid;padding-inline-start:1rem;margin-inline:auto;font-weight:bold;font-style:italic}</style></head><body class="page example-nodejs-application"><header><h1 class=text-fit><span><a data-text="Greg Daynes" href="/">Greg Daynes</a></span><span aria-hidden=true style="visibility: hidden">Greg Daynes</span></h1><p class=text-fit><span><span>Full Stack Software Design, Development & Management</span></span><span aria-hidden=true style="visibility: hidden">Full Stack Software Design, Development & Management</span></p><nav><ul><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/resume">Resume</a></li><li><a href="/projects">Projects</a></li><li><a href="/notebook">Notebook</a></li></ul></nav></header><div class=with-sidebar><main><article><h2>Example NodeJS Application</h2><p><em>Note: While this is outdated, some of the takeaways are still valid. I hope to do a follow up - with the same idea using current proven practices and dependencies.</em></p><p>A <em>mostly</em> complete example for a monolith, which is also suitable for building “microservices”.</p><ul><li>Mocha used as test runner for both the Api and the frontend (frontend excluded from this repository). I would personally choose to use <a href="//www.npmjs.com/package/tap">tap</a> for the Api, and Jest for the Frontend. I dislike Jest for testing Node because of the changes made to the runtime. There are also issues with slow adoption of newer capabilities (because of the these changes)—eg: ESM</li><li>Replacing the database with SQLite when testing has been a positive choice for fast development (TDD). Given the choice again I would opt to use an in-memory-tuned instance of the production database for integration testing.</li><li>No workspaces. I ran into an issue with other developers NPM not working with the <em>then new</em> workspace feature (NPM @ 7). Yarn would have worked for this, as well as PNPM.</li><li>Hygen for generating code based on <code class="language-plaintext highlighter-rouge">ejs</code> templates - <a href="//www.npmjs.com/package/copy-template-dir">copy-template-dir</a> or similar.</li><li>CLI came after most of the application and web interface was complete. Nowadays I would build the CLI in parallel with the application logic. This benefits development by not having to remember REPL commands or building out administration UIs.</li></ul><p>The repository contains <code class="language-plaintext highlighter-rouge">app-example-requests.paw</code> and <code class="language-plaintext highlighter-rouge">app-example-requests-postman.json</code> for interacting with the api through Paw or Postman.</p><p>Repo: <a href="//github.com/gregdaynes/app-example">app-example</a></p><p>Readme in repository has in-depth documentation on the organization, cli, code generation, testing, database.</p><div class="language-sh highlighter-rouge"><div class=highlight><pre class=highlight><code><span class="c"># Install modules for each area of the application</span>
<span class="nv">$ </span>npm run setup

<span class="c"># Add required keyvalues to .env</span>
<span class="c"># starting the application will inform you what required values are missing</span>
<span class="c"># you can use the following</span>
<span class="nv">JWT_SECRET</span><span class="o">=</span>supersecret
<span class="nv">DB_CLIENT</span><span class="o">=</span>mysql
<span class="nv">DB_USER</span><span class="o">=</span>root
<span class="nv">DB_PASSWORD</span><span class="o">=</span>root
<span class="nv">DB_DATABASE</span><span class="o">=</span>app
<span class="nv">DB_HOST</span><span class="o">=</span>127.0.0.1
<span class="nv">DB_PORT</span><span class="o">=</span>3306
<span class="nv">TEST_DB_CLIENT</span><span class="o">=</span>sqlite3
<span class="nv">TEST_DB_FILENAME</span><span class="o">=</span>:memory:
<span class="nv">TEST_DB_POOL_MIN</span><span class="o">=</span>1
<span class="nv">TEST_DB_POOL_MAX</span><span class="o">=</span>1

<span class="c"># Setup Database</span>
<span class="c"># if you don't have a local MySQL install, you can use the docker compose file included in this project to set up quickly.</span>
<span class="c"># Note that the envars for MYSQL_ROOT_PASSWORD and MYSQL_DATABASE need to be defined in .env before running the following command.</span>
<span class="nv">$ </span>docker compose up <span class="nt">-d</span>

<span class="c"># Migrate + Seed database</span>
<span class="c"># you can use the script `db` to perform operations with KnexJS or use the CLI</span>
<span class="nv">$ </span>npm run cli

<span class="nv">$ </span>npm run db <span class="nt">--</span> migrate:latest
<span class="nv">$ </span>npm run db <span class="nt">--</span> seed:run

<span class="c"># Running API Server</span>
<span class="nv">$ </span>npm run start:api
<span class="c"># pino-pretty can provide cleaner stdout logs for dev</span>
<span class="nv">$ </span>npm run start:api | npx pino-pretty

<span class="c"># Running Tests</span>
<span class="c"># app tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>:app
<span class="c"># api tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>:api
<span class="c"># api &amp; app tests</span>
<span class="nv">$ </span>npm run <span class="nb">test</span>
</code></pre></div></div></article></main><aside><h2>Projects</h2><nav><ul><li class=""><a href="/project/2025/06/08/earthquakes.html"> Earthquakes with Leaflet.js & Go</a></li><li class=""><a href="/project/2023/12/28/fellow-stagg-repair.html"> Fellow Stagg Repair</a></li><li class=""><a href="/project/2023/12/03/hyde-fonts.html"> Hyde Fonts</a></li><li class=""><a href="/project/2018/04/07/project-hyde.html"> Project Hyde</a></li></ul></nav><a href="/projects">More Projects</a><h2>Notes</h2><nav><ul><li class=""><a href="/note/2024/07/30/callable-class-instance.html"> Callable Class Instance</a></li><li class=""><a href="/note/2024/07/29/web-components.html"> Web Components</a></li><li class=""><a href="/note/2024/02/10/hexdump-shell-command.html"> Hexdump shell command</a></li><li class=""><a href="/note/2023/12/08/fixing-homebrew-permissions.html"> Fixing Homebrew permissions when using ASDF</a></li><li class=""><a href="/note/2021/09/18/node-binary-artifacts.html"> Node CLI / Binary Artifacts</a></li></ul></nav><a href="/notebook">More Notes</a></aside></div><footer><p>©2024 Gregory Daynes</p><nav><ul><li><a href="mailto:email@gregdaynes.com">Contact</a></li><li><a href="/privacy.txt">Privacy</a></li><li><a href="/humans.txt">Humans</a></li><li><a href="/robots.txt">Robots</a></li><li><a href="/sitemap.xml">Site Map</a></li><li><a href="/feed.xml">RSS</a></li></ul></nav><p><small>Content on this site is licensed under Creative Common Attribution-ShareAlike 4.0 International License. All code content is licensed under the MIT license, unless an excerpt from a larger work under another license.</small></p></footer></body></html>